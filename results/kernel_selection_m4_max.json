{
  "device": "M4 Max",
  "model": "GLM-4.7-Flash-Trellis-MM",
  "batch_sizes": [
    1,
    2,
    4,
    8,
    16,
    24,
    32,
    48,
    64
  ],
  "kernel_variants": [
    "decode",
    "prefill4",
    "prefill4_fp32acc",
    "large_batch",
    "large_batch_fp32acc",
    "base",
    "base_fp32acc"
  ],
  "results": {
    "1": {
      "decode": {
        "mean_ms": 16.824594181089196,
        "min_ms": 16.578082999330945,
        "max_ms": 17.107584004406817,
        "std_ms": 0.14397027389411235
      },
      "prefill4": {
        "mean_ms": 46.46691014029784,
        "min_ms": 46.22366699913982,
        "max_ms": 46.89974999928381,
        "std_ms": 0.16462573342766804
      },
      "prefill4_fp32acc": {
        "mean_ms": 46.49972328013973,
        "min_ms": 46.14962499181274,
        "max_ms": 47.0173329958925,
        "std_ms": 0.21698987713378542
      },
      "large_batch": {
        "mean_ms": 13.387768359098118,
        "min_ms": 12.896250002086163,
        "max_ms": 14.299249989562668,
        "std_ms": 0.28971068911967934
      },
      "large_batch_fp32acc": {
        "mean_ms": 13.074222501018085,
        "min_ms": 12.812374989152886,
        "max_ms": 13.621208010590635,
        "std_ms": 0.1931909414118708
      },
      "base": {
        "mean_ms": 12.913900018611457,
        "min_ms": 12.554458997328766,
        "max_ms": 13.538208993850276,
        "std_ms": 0.2296388807263006
      },
      "base_fp32acc": {
        "mean_ms": 14.242283319472335,
        "min_ms": 13.65783299843315,
        "max_ms": 14.89920899621211,
        "std_ms": 0.2946692330545789
      }
    },
    "2": {
      "decode": {
        "mean_ms": 16.93085839797277,
        "min_ms": 16.573166998568922,
        "max_ms": 17.394416994648054,
        "std_ms": 0.23799404508889352
      },
      "prefill4": {
        "mean_ms": 46.435650881321635,
        "min_ms": 46.197540999855846,
        "max_ms": 46.912583988159895,
        "std_ms": 0.1641945284606347
      },
      "prefill4_fp32acc": {
        "mean_ms": 46.565359940286726,
        "min_ms": 46.26470799848903,
        "max_ms": 47.06687499128748,
        "std_ms": 0.18232332628899045
      },
      "large_batch": {
        "mean_ms": 13.599238279566634,
        "min_ms": 13.033916999120265,
        "max_ms": 14.497208991087973,
        "std_ms": 0.30015270105718256
      },
      "large_batch_fp32acc": {
        "mean_ms": 13.351139039732516,
        "min_ms": 12.451625007088296,
        "max_ms": 14.081000001169741,
        "std_ms": 0.5173144614197152
      },
      "base": {
        "mean_ms": 22.28968504088698,
        "min_ms": 13.500415996531956,
        "max_ms": 24.887374995159917,
        "std_ms": 3.3566315555368944
      },
      "base_fp32acc": {
        "mean_ms": 19.716968259599525,
        "min_ms": 15.654375005397014,
        "max_ms": 22.060417002649046,
        "std_ms": 1.9655948362518174
      }
    },
    "4": {
      "decode": {
        "mean_ms": 16.6344525385648,
        "min_ms": 16.22066699201241,
        "max_ms": 17.923874998814426,
        "std_ms": 0.3681583588098241
      },
      "prefill4": {
        "mean_ms": 46.825932579813525,
        "min_ms": 45.688666999922134,
        "max_ms": 47.58558400499169,
        "std_ms": 0.4020333644504338
      },
      "prefill4_fp32acc": {
        "mean_ms": 46.86442410136806,
        "min_ms": 46.35279200738296,
        "max_ms": 47.57958299887832,
        "std_ms": 0.3047473003181328
      },
      "large_batch": {
        "mean_ms": 15.513636618561577,
        "min_ms": 12.538625000161119,
        "max_ms": 25.92733400524594,
        "std_ms": 3.1342375471455455
      },
      "large_batch_fp32acc": {
        "mean_ms": 20.64927239989629,
        "min_ms": 13.84120799775701,
        "max_ms": 28.08095799991861,
        "std_ms": 5.4966471823549625
      },
      "base": {
        "mean_ms": 21.375939199351706,
        "min_ms": 13.348667009267956,
        "max_ms": 27.426165994256735,
        "std_ms": 4.9519764666647825
      },
      "base_fp32acc": {
        "mean_ms": 18.98173908033641,
        "min_ms": 13.736082997638732,
        "max_ms": 28.069833002518862,
        "std_ms": 3.502750947505984
      }
    },
    "8": {
      "decode": {
        "mean_ms": 16.738329959916882,
        "min_ms": 16.23824999842327,
        "max_ms": 17.59133300220128,
        "std_ms": 0.3780210173546918
      },
      "prefill4": {
        "mean_ms": 46.98501332051819,
        "min_ms": 45.77874999085907,
        "max_ms": 51.793749997159466,
        "std_ms": 1.062760601269733
      },
      "prefill4_fp32acc": {
        "mean_ms": 46.740720919915475,
        "min_ms": 45.547665999038145,
        "max_ms": 52.14391699701082,
        "std_ms": 1.044145631993725
      },
      "large_batch": {
        "mean_ms": 14.490630820801016,
        "min_ms": 12.442291001207195,
        "max_ms": 24.502334010321647,
        "std_ms": 1.931261382647087
      },
      "large_batch_fp32acc": {
        "mean_ms": 14.908964159840252,
        "min_ms": 12.56495800043922,
        "max_ms": 16.44033299817238,
        "std_ms": 1.3261453639753322
      },
      "base": {
        "mean_ms": 13.88004577922402,
        "min_ms": 12.320209003519267,
        "max_ms": 23.461167002096772,
        "std_ms": 2.422914069077525
      },
      "base_fp32acc": {
        "mean_ms": 15.941785039904063,
        "min_ms": 13.232166995294392,
        "max_ms": 18.743124994216487,
        "std_ms": 1.3965000452175738
      }
    },
    "16": {
      "decode": {
        "mean_ms": 17.16454090026673,
        "min_ms": 16.802333004307002,
        "max_ms": 18.06633299565874,
        "std_ms": 0.28103911449396085
      },
      "prefill4": {
        "mean_ms": 47.593585020513274,
        "min_ms": 46.0804580070544,
        "max_ms": 52.66341599053703,
        "std_ms": 1.165507974147946
      },
      "prefill4_fp32acc": {
        "mean_ms": 48.512771720124874,
        "min_ms": 46.31641600281,
        "max_ms": 53.09570899407845,
        "std_ms": 1.5284129719952007
      },
      "large_batch": {
        "mean_ms": 14.45738917827839,
        "min_ms": 13.374208007007837,
        "max_ms": 15.007374997367151,
        "std_ms": 0.2998801603842506
      },
      "large_batch_fp32acc": {
        "mean_ms": 14.271393381350208,
        "min_ms": 13.528291005059145,
        "max_ms": 15.499166998779401,
        "std_ms": 0.42975525925313907
      },
      "base": {
        "mean_ms": 14.337095820810646,
        "min_ms": 12.923000002047047,
        "max_ms": 24.196458005462773,
        "std_ms": 1.4802912512827344
      },
      "base_fp32acc": {
        "mean_ms": 16.598954939981923,
        "min_ms": 13.822666005580686,
        "max_ms": 19.589792005717754,
        "std_ms": 1.1390567080308542
      }
    },
    "24": {
      "decode": {
        "mean_ms": 17.484905838791747,
        "min_ms": 16.865165991475806,
        "max_ms": 18.40749999973923,
        "std_ms": 0.387191942272637
      },
      "prefill4": {
        "mean_ms": 222.53169169969624,
        "min_ms": 216.76495800784323,
        "max_ms": 239.77683400153182,
        "std_ms": 5.202708539678561
      },
      "prefill4_fp32acc": {
        "mean_ms": 224.39741592039354,
        "min_ms": 217.82945899758488,
        "max_ms": 239.12720900261775,
        "std_ms": 5.331325475645336
      },
      "large_batch": {
        "mean_ms": 113.77748419996351,
        "min_ms": 110.67554100009147,
        "max_ms": 117.89433399098925,
        "std_ms": 1.6756835732362325
      },
      "large_batch_fp32acc": {
        "mean_ms": 113.51849582017167,
        "min_ms": 110.07945900200866,
        "max_ms": 116.56075000064448,
        "std_ms": 1.4186019036958062
      },
      "base": {
        "mean_ms": 195.27947920141742,
        "min_ms": 190.41850000212435,
        "max_ms": 200.9242079948308,
        "std_ms": 2.5574785544846144
      },
      "base_fp32acc": {
        "mean_ms": 201.5163491203566,
        "min_ms": 195.51804100046866,
        "max_ms": 205.92558300995734,
        "std_ms": 2.048612118321689
      }
    },
    "32": {
      "decode": {
        "mean_ms": 17.992645002377685,
        "min_ms": 17.66525000857655,
        "max_ms": 18.38000000861939,
        "std_ms": 0.14123048900164956
      },
      "prefill4": {
        "mean_ms": 229.82934167986969,
        "min_ms": 220.27150000212714,
        "max_ms": 248.40395899082068,
        "std_ms": 6.446784187458249
      },
      "prefill4_fp32acc": {
        "mean_ms": 236.99023160064826,
        "min_ms": 225.0502920069266,
        "max_ms": 248.22300000232644,
        "std_ms": 5.208771044713413
      },
      "large_batch": {
        "mean_ms": 115.36479502014117,
        "min_ms": 113.31916699418798,
        "max_ms": 119.49629199807532,
        "std_ms": 1.3738293647264905
      },
      "large_batch_fp32acc": {
        "mean_ms": 115.01763250125805,
        "min_ms": 112.12125000020023,
        "max_ms": 119.50437499035615,
        "std_ms": 1.3629394720228822
      },
      "base": {
        "mean_ms": 196.52631579927402,
        "min_ms": 194.07312499242835,
        "max_ms": 203.52845899469685,
        "std_ms": 2.0553673355031816
      },
      "base_fp32acc": {
        "mean_ms": 201.32229838025523,
        "min_ms": 194.7680410085013,
        "max_ms": 210.16579199931584,
        "std_ms": 3.7390782978824038
      }
    },
    "48": {
      "decode": {
        "mean_ms": 17.590774219715968,
        "min_ms": 17.352791997836903,
        "max_ms": 18.04712500597816,
        "std_ms": 0.16251940318446642
      },
      "prefill4": {
        "mean_ms": 422.3518508012057,
        "min_ms": 406.5442080027424,
        "max_ms": 451.79187500616536,
        "std_ms": 8.036202678316524
      },
      "prefill4_fp32acc": {
        "mean_ms": 432.90947250061436,
        "min_ms": 412.27729100501165,
        "max_ms": 464.89008399657905,
        "std_ms": 12.736658998381317
      },
      "large_batch": {
        "mean_ms": 225.28219085972523,
        "min_ms": 213.64766599435825,
        "max_ms": 234.15087501052767,
        "std_ms": 5.600137374826838
      },
      "large_batch_fp32acc": {
        "mean_ms": 219.62989255902357,
        "min_ms": 215.97158300573938,
        "max_ms": 223.37454100488685,
        "std_ms": 1.5720358504103196
      },
      "base": {
        "mean_ms": 382.5542408795445,
        "min_ms": 366.6322909994051,
        "max_ms": 389.7001250006724,
        "std_ms": 3.7914428823341195
      },
      "base_fp32acc": {
        "mean_ms": 394.0270116596366,
        "min_ms": 388.36925000941847,
        "max_ms": 415.6999580009142,
        "std_ms": 6.539607104637538
      }
    },
    "64": {
      "decode": {
        "mean_ms": 17.68229752109619,
        "min_ms": 17.12566700007301,
        "max_ms": 18.300541007192805,
        "std_ms": 0.3446816732463821
      },
      "prefill4": {
        "mean_ms": 425.72269083873834,
        "min_ms": 419.3415829940932,
        "max_ms": 437.83379199157935,
        "std_ms": 5.191474202394473
      },
      "prefill4_fp32acc": {
        "mean_ms": 430.6969858807861,
        "min_ms": 420.4349589999765,
        "max_ms": 482.94733300281223,
        "std_ms": 14.15894240929301
      },
      "large_batch": {
        "mean_ms": 220.08112840005197,
        "min_ms": 215.92012500332203,
        "max_ms": 231.72683399752714,
        "std_ms": 3.2579946301519964
      },
      "large_batch_fp32acc": {
        "mean_ms": 220.19265747920144,
        "min_ms": 215.84562498901505,
        "max_ms": 228.5588750091847,
        "std_ms": 2.5719183514872053
      },
      "base": {
        "mean_ms": 380.0701224600198,
        "min_ms": 375.60262499027885,
        "max_ms": 386.9984159973683,
        "std_ms": 1.7649806037138844
      },
      "base_fp32acc": {
        "mean_ms": 395.7608173994231,
        "min_ms": 392.5710000039544,
        "max_ms": 414.90487499686424,
        "std_ms": 3.892455863304663
      }
    }
  },
  "recommendations": {
    "1": {
      "optimal": "base",
      "optimal_ms": 12.913900018611457,
      "current": "decode"
    },
    "2": {
      "optimal": "large_batch_fp32acc",
      "optimal_ms": 13.351139039732516,
      "current": "prefill4"
    },
    "4": {
      "optimal": "large_batch",
      "optimal_ms": 15.513636618561577,
      "current": "prefill4"
    },
    "8": {
      "optimal": "base",
      "optimal_ms": 13.88004577922402,
      "current": "prefill4"
    },
    "16": {
      "optimal": "large_batch_fp32acc",
      "optimal_ms": 14.271393381350208,
      "current": "prefill4"
    },
    "24": {
      "optimal": "decode",
      "optimal_ms": 17.484905838791747,
      "current": "base"
    },
    "32": {
      "optimal": "decode",
      "optimal_ms": 17.992645002377685,
      "current": "base"
    },
    "48": {
      "optimal": "decode",
      "optimal_ms": 17.590774219715968,
      "current": "large_batch"
    },
    "64": {
      "optimal": "decode",
      "optimal_ms": 17.68229752109619,
      "current": "large_batch"
    }
  },
  "thresholds": {
    "decode_max": 64,
    "large_batch_min": 4
  }
}